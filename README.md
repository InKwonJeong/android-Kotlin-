# android App Architecture

### 모바일 앱 사용자 환경

- 데스크톱 앱의 경우 프로그램 실행 런처에서 단일 진입점으로 하나의 모노폴리식 프로세스로 실행된다.   

- android App은 Activity, Fragment, Service, ContentsProvider, BoardcastReceiver의 여러 앱 구성요소가 포함된다.   

- manifest에 위의 구성요소가 등록되며 Android OS는 manifest파일을 사용하여 기기의 전반적인 환경에 App을 통합하는 방법을 결정한다.   

- android App은 많은 여러가지 구성요소가 포함되어 있으며, 사용자가 짧은 시간내에 여러 다른 앱과 상호작용할 떄도 많기 떄문에 사용자 중심의 다양한 워크플로우 및 작업에 맞게 조정될 수 있어야한다.   

- 예를 들어 소셜네트워크 앱에서 사진을 공유하는 상황.

  1. 앱이 카메라 인텐트를 발생시키면 Android OS에서 카메라 앱을 실행한다. 이 시점에 사용자는 소셜 네트워크 앱에서 나간 상황이지만 앱 사용환경은 끊김 없이 연결됩니다.

  2. 카메라 앱은 사진 파일 선택기 실행처럼 다른 인텐트를 발생 시켜서 다른 앱을 실행할 수도 있습니다.

  3. 사진을 선택하고 나서 사용자가 다시 소셜 네트워크 앱으로 돌아와서 사진을 공유한다.

- 위 과정에서 언제든지 전화나 알림에 의해 사용환경이 중단될 수 있습니다. 전화나 알림을 받고 나서 사용자는 계속해서 사진공유 프로세스로 돌아가서 작업을 계속할 수 있어야한다. 모바일기기에서는 이렇게 앱을 바꾸어 실행하는 동작이 일반적이므로, 앱에서 이러한 흐름을 올바르게 처리할수 있어야 한다.   

- 모바일 환경은 자원(CPU, Memory등)이 제한되어 있으므로 운영체제에서 새로운 앱을 위한 공간을 확보하도록 언제든지 앱의 일부 프로세스를 종료해야 할 수있다.   

- 앱의 구성요소는 개별적(독립적), 비순차적으로 실행될수 있어야하며, 운영체제 또는 사용자가 언제든지 앱 구성요소를 종료할 수 있다. 이러한 일은 개발자가 직접 제어할 수 없기 때문에 **앱 구성요소에 앱데이터나 상태를 저장해서는 안되며 앱의 구성요소가 서로 종속되면 안된다.**   

### 일반 아키텍쳐의 원칙
#### 앱 데이터와 상태를 저장하는데 앱 구성요소를 사용할 수 없다면 앱을 어떻게 설계해야 하나?

1. Separation of concerns

 - 컴퓨터 과학에서 관심사 분리(separation of concerns, SoC)는 컴퓨터 프로그램을 구별된 부분으로 분리시키는 디자인 원칙으로, 각 부문은 개개의 관심사를 해결한다. 관심사란 컴퓨터 프로그램 코드에 영향을 미치는 정보의 집합이다. 관심사는 코드 최적화가 필요한 하드웨어의 세세한 부분만큼 포괄적이거나, 시작할 클래스의 이름처럼 구체적일 수 있다. 관심사 분리를 이용하면 프로그램의 설계, 디플로이, 이용의 일부 관점에 더 높은 정도의 자유가 생긴다. 이 가운데 일반적인 것은 코드의 단순화 및 유지보수의 더 높은 수준의 자유이다. 관심사 분리는 추상화의 일종이다. 대부분의 추상화에서처럼 인터페이스의 추가는 필수이며 실행에 쓰이는 더 순수한 코드가 있는 것이 일반적이다.

 - Activity 또는 Fragment에 모든 코드를 작성하는 실수는 자주 일어난다. UI 기반의 클래스는 UI 및 운영체제와 상호작용을 처리하는 로직만 포함되어야 하며 UI 기반 클래스를 최대한 가볍게 유지하여 많은 생명주기에 관련된 문제를 피할수가 있다.

-  Activity 및 Fragment 구현은 개발자의 것이 아니다. 오히려 Activity 및 Fragment는 Android OS와 앱간의 연결을 보여주는
연결 클래스이다. Activity 및 Fragment은 유저와의 상호작용 또는 시스템의 조건(메모리 부족)에 의해 언제라도 제거 될수있다
좋은 사용자 환경과 수월한 앱관리 환경을 제공하려면 UI기반 클래스에 대한 의존성을 최소화 해야된다.

2. Drive UI from a model

- 또 하나의 중요한 원칙은 모델에서 UI를 만들어야 한다는 것입니다. 가능한 지속적인 모델을 이용해야된다.
모델은 앱의 데이터 처리를 담당하는 구성요소로써, 앱의 View 객체 및 앱 구성요소(Activity등)과 독립적으로 구성되어 앱의 수명주기및 관련문제의 영향을 받지 말아야한다.

- 지속적인 모델이 필요한 이유
  1. android OS에서 리소스를 확보하기 위해 앱을 제거해도 사용자 데이터가 삭제되지 않습니다.
  2. 네트워크 연결이 취약하거나 연결되어 있지 않아도 앱의 지속적인 작동을 할 수 있습니다.

- 데이터 관리의 책임이 잘 정의된 모델 클래스를 기반으로 앱을 만든다면 쉽게 태스트 하고 일관성을 유지할 수 있습니다.
